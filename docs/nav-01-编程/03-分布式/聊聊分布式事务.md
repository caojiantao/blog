---
title: 聊聊分布式事务
permalink: "1709035583793"
---

在分布式系统中，事务管理一直是一个复杂而又关键的问题。传统的关系型数据库虽然提供了 ACID（原子性、一致性、隔离性和持久性）事务的支持，但是在分布式场景下，由于网络延迟、节点故障等因素的影响，保证分布式事务的 ACID 特性变得更加困难。

## 2PC

![](http://media.caojiantao.site:1024/blog/6060152b-0ffb-4e01-b9f0-7bfb71577087.png)

两阶段提交（Two-Phase Commit，2PC）是一种经典的分布式事务处理协议，旨在确保分布式环境下的多个参与者对某一事务的操作能够以原子方式进行提交或回滚，从而保证事务的一致性。

在互联网业务场景中，由于2PC协议存在单点故障、性能开销、阻塞问题和复杂性等局限性，通常会选择更轻量级和灵活的事务处理方案。

## TCC

![](http://media.caojiantao.site:1024/blog/5ed96a3f-b680-48e4-94dd-9d6880b69daf.png)

TCC（Try-Confirm-Cancel）是一种基于补偿机制的分布式事务处理模式，旨在解决分布式系统中的事务一致性问题。它将整个事务拆分为三个阶段：尝试（Try）、确认（Confirm）和取消（Cancel），通过执行相应的补偿操作来保证事务的一致性。

TCC 将事务的提交回滚提升到业务层，可以看作是业务层上的 2PC 版本。TCC 在实践中应用较少，主要因为其需要显式编写补偿逻辑、处理幂等性等复杂性，以及对业务逻辑的高要求等因素。

## 本地消息表

## 事务消息

## 本地消息表 + MQ 中间件